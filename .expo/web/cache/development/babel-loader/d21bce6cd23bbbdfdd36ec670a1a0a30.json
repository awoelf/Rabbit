{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _isUndefined from \"lodash/isUndefined\";\nimport _includes from \"lodash/includes\";\nimport _isEmpty from \"lodash/isEmpty\";\nimport _times from \"lodash/times\";\nimport { useState, useCallback, useEffect, useRef } from 'react';\nimport useScrollTo from \"../useScrollTo\";\nimport { Constants } from \"../../commons/new\";\nexport var OffsetType;\n(function (OffsetType) {\n  OffsetType[\"CENTER\"] = \"CENTER\";\n  OffsetType[\"DYNAMIC\"] = \"DYNAMIC\";\n  OffsetType[\"LEFT\"] = \"LEFT\";\n  OffsetType[\"RIGHT\"] = \"RIGHT\";\n})(OffsetType || (OffsetType = {}));\nvar useScrollToItem = function useScrollToItem(props) {\n  var propsScrollViewRef = props.scrollViewRef,\n    itemsCount = props.itemsCount,\n    selectedIndex = props.selectedIndex,\n    _props$offsetType = props.offsetType,\n    offsetType = _props$offsetType === void 0 ? OffsetType.CENTER : _props$offsetType,\n    _props$addOffsetMargi = props.addOffsetMargin,\n    addOffsetMargin = _props$addOffsetMargi === void 0 ? true : _props$addOffsetMargi,\n    _props$outerSpacing = props.outerSpacing,\n    outerSpacing = _props$outerSpacing === void 0 ? 0 : _props$outerSpacing,\n    _props$innerSpacing = props.innerSpacing,\n    innerSpacing = _props$innerSpacing === void 0 ? 0 : _props$innerSpacing;\n  var itemsWidths = useRef(_times(itemsCount, function () {\n    return null;\n  }));\n  var currentIndex = useRef(selectedIndex || 0);\n  var _useState = useState({\n      CENTER: [],\n      LEFT: [],\n      RIGHT: []\n    }),\n    _useState2 = _slicedToArray(_useState, 2),\n    offsets = _useState2[0],\n    setOffsets = _useState2[1];\n  var _useScrollTo = useScrollTo({\n      scrollViewRef: propsScrollViewRef\n    }),\n    scrollViewRef = _useScrollTo.scrollViewRef,\n    scrollTo = _useScrollTo.scrollTo,\n    onContentSizeChange = _useScrollTo.onContentSizeChange,\n    onLayout = _useScrollTo.onLayout;\n  var setSnapBreakpoints = useCallback(function (itemsWidths) {\n    if (_isEmpty(itemsWidths)) {\n      return;\n    }\n    var screenCenter = Constants.screenWidth / 2;\n    var index = 0;\n    var centeredOffsets = [];\n    var currentCenterOffset = outerSpacing;\n    var leftOffsets = [];\n    leftOffsets.push(outerSpacing - innerSpacing);\n    var rightOffsets = [];\n    rightOffsets.push(-Constants.screenWidth + itemsWidths[0] + outerSpacing + innerSpacing);\n    while (index < itemsCount) {\n      centeredOffsets[index] = currentCenterOffset - screenCenter + itemsWidths[index] / 2;\n      ++index;\n      currentCenterOffset += itemsWidths[index - 1] + innerSpacing;\n      leftOffsets[index] = leftOffsets[index - 1] + itemsWidths[index - 1] + innerSpacing;\n      rightOffsets[index] = rightOffsets[index - 1] + itemsWidths[index] + innerSpacing;\n    }\n    if (addOffsetMargin) {\n      index = 1;\n      while (index < itemsCount - 1) {\n        leftOffsets[index] -= itemsWidths[index - 1];\n        rightOffsets[index] += itemsWidths[index + 1] + innerSpacing;\n        ++index;\n      }\n    }\n    setOffsets({\n      CENTER: centeredOffsets,\n      LEFT: leftOffsets,\n      RIGHT: rightOffsets\n    });\n  }, [itemsCount, outerSpacing, innerSpacing, addOffsetMargin]);\n  var onItemLayout = useCallback(function (event, index) {\n    var width = event.nativeEvent.layout.width;\n    itemsWidths.current[index] = width;\n    if (!_includes(itemsWidths.current, null)) {\n      setSnapBreakpoints(itemsWidths.current);\n    }\n  }, [setSnapBreakpoints]);\n  var focusIndex = useCallback(function (index) {\n    var animated = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n    if (index >= 0 && offsets.CENTER.length > index) {\n      if (offsetType !== OffsetType.DYNAMIC) {\n        scrollTo(offsets[offsetType][index], animated);\n      } else {\n        var movingLeft = index < currentIndex.current;\n        currentIndex.current = index;\n        scrollTo(movingLeft ? offsets[OffsetType.RIGHT][index] : offsets[OffsetType.LEFT][index], animated);\n      }\n    }\n  }, [offsets, offsetType, scrollTo]);\n  useEffect(function () {\n    if (!_isUndefined(selectedIndex)) {\n      focusIndex(selectedIndex);\n    }\n  }, [selectedIndex, focusIndex]);\n  return {\n    scrollViewRef: scrollViewRef,\n    onItemLayout: onItemLayout,\n    itemsWidths: offsets.CENTER.length > 0 ? itemsWidths.current : [],\n    focusIndex: focusIndex,\n    onContentSizeChange: onContentSizeChange,\n    onLayout: onLayout\n  };\n};\nuseScrollToItem.offsetType = OffsetType;\nexport default useScrollToItem;","map":{"version":3,"names":["_isUndefined","_includes","_isEmpty","_times","useState","useCallback","useEffect","useRef","useScrollTo","Constants","OffsetType","useScrollToItem","props","propsScrollViewRef","scrollViewRef","itemsCount","selectedIndex","offsetType","CENTER","addOffsetMargin","outerSpacing","innerSpacing","itemsWidths","currentIndex","LEFT","RIGHT","offsets","setOffsets","scrollTo","onContentSizeChange","onLayout","setSnapBreakpoints","screenCenter","screenWidth","index","centeredOffsets","currentCenterOffset","leftOffsets","push","rightOffsets","onItemLayout","event","width","nativeEvent","layout","current","focusIndex","animated","length","DYNAMIC","movingLeft"],"sources":["C:/Users/Alex/Documents/development/Rabbit/node_modules/react-native-ui-lib/src/hooks/useScrollToItem/index.js"],"sourcesContent":["import _isUndefined from \"lodash/isUndefined\";\nimport _includes from \"lodash/includes\";\nimport _isEmpty from \"lodash/isEmpty\";\nimport _times from \"lodash/times\";\nimport { useState, useCallback, useEffect, useRef } from 'react';\nimport useScrollTo from \"../useScrollTo\";\nimport { Constants } from \"../../commons/new\";\nexport let OffsetType;\n(function (OffsetType) {\n  OffsetType[\"CENTER\"] = \"CENTER\";\n  OffsetType[\"DYNAMIC\"] = \"DYNAMIC\";\n  OffsetType[\"LEFT\"] = \"LEFT\";\n  OffsetType[\"RIGHT\"] = \"RIGHT\";\n})(OffsetType || (OffsetType = {}));\nconst useScrollToItem = props => {\n  const {\n    scrollViewRef: propsScrollViewRef,\n    itemsCount,\n    selectedIndex,\n    offsetType = OffsetType.CENTER,\n    addOffsetMargin = true,\n    outerSpacing = 0,\n    innerSpacing = 0\n  } = props;\n  const itemsWidths = useRef(_times(itemsCount, () => null));\n  const currentIndex = useRef(selectedIndex || 0);\n  const [offsets, setOffsets] = useState({\n    CENTER: [],\n    LEFT: [],\n    RIGHT: []\n  });\n  const {\n    scrollViewRef,\n    scrollTo,\n    onContentSizeChange,\n    onLayout\n  } = useScrollTo({\n    scrollViewRef: propsScrollViewRef\n  });\n\n  // TODO: reset?\n  //   useEffect(() => {\n  //     itemsWidths.current = _.times(itemsCount, () => null);\n  //   }, [itemsCount]);\n\n  // const contentWidth = _.sum(itemsWidths);\n  // TODO: const scrollEnabled = contentWidth.current > containerWidth;\n\n  const setSnapBreakpoints = useCallback(itemsWidths => {\n    if (_isEmpty(itemsWidths)) {\n      return;\n    }\n    const screenCenter = Constants.screenWidth / 2; // TODO: change to something more dynamic?\n    let index = 0;\n    const centeredOffsets = [];\n    let currentCenterOffset = outerSpacing;\n    const leftOffsets = [];\n    leftOffsets.push(outerSpacing - innerSpacing);\n    const rightOffsets = [];\n    rightOffsets.push(-Constants.screenWidth + itemsWidths[0] + outerSpacing + innerSpacing);\n    while (index < itemsCount) {\n      centeredOffsets[index] = currentCenterOffset - screenCenter + itemsWidths[index] / 2;\n      ++index;\n      currentCenterOffset += itemsWidths[index - 1] + innerSpacing;\n      leftOffsets[index] = leftOffsets[index - 1] + itemsWidths[index - 1] + innerSpacing;\n      rightOffsets[index] = rightOffsets[index - 1] + itemsWidths[index] + innerSpacing;\n    }\n    if (addOffsetMargin) {\n      index = 1;\n      while (index < itemsCount - 1) {\n        leftOffsets[index] -= itemsWidths[index - 1];\n        rightOffsets[index] += itemsWidths[index + 1] + innerSpacing;\n        ++index;\n      }\n    }\n    setOffsets({\n      CENTER: centeredOffsets,\n      LEFT: leftOffsets,\n      RIGHT: rightOffsets\n    }); // default for DYNAMIC is CENTER\n  }, [itemsCount, outerSpacing, innerSpacing, addOffsetMargin]);\n  const onItemLayout = useCallback((event, index) => {\n    const {\n      width\n    } = event.nativeEvent.layout;\n    itemsWidths.current[index] = width;\n    if (!_includes(itemsWidths.current, null)) {\n      setSnapBreakpoints(itemsWidths.current);\n    }\n  }, [setSnapBreakpoints]);\n  const focusIndex = useCallback((index, animated = true) => {\n    if (index >= 0 && offsets.CENTER.length > index) {\n      if (offsetType !== OffsetType.DYNAMIC) {\n        scrollTo(offsets[offsetType][index], animated);\n      } else {\n        const movingLeft = index < currentIndex.current;\n        currentIndex.current = index;\n        scrollTo(movingLeft ? offsets[OffsetType.RIGHT][index] : offsets[OffsetType.LEFT][index], animated);\n      }\n    }\n  }, [offsets, offsetType, scrollTo]);\n  useEffect(() => {\n    if (!_isUndefined(selectedIndex)) {\n      focusIndex(selectedIndex);\n    }\n  }, [selectedIndex, focusIndex]);\n  return {\n    scrollViewRef,\n    onItemLayout,\n    itemsWidths: offsets.CENTER.length > 0 ? itemsWidths.current : [],\n    focusIndex,\n    onContentSizeChange,\n    onLayout\n  };\n};\nuseScrollToItem.offsetType = OffsetType;\nexport default useScrollToItem;"],"mappings":"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"},"metadata":{},"sourceType":"module"}