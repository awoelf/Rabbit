{"ast":null,"code":"import _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nvar _excluded = [\"data\", \"onOrderChange\", \"enableHaptic\", \"scale\"];\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nimport _reduce from \"lodash/reduce\";\nimport _filter from \"lodash/filter\";\nimport _mapKeys from \"lodash/mapKeys\";\nimport _map from \"lodash/map\";\nimport React, { useMemo, useCallback } from 'react';\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport { useSharedValue } from 'react-native-reanimated';\nimport { GestureHandlerRootView } from 'react-native-gesture-handler';\nimport SortableListContext from \"./SortableListContext\";\nimport SortableListItem from \"./SortableListItem\";\nimport { useDidUpdate, useThemeProps } from \"../../hooks\";\nimport { SortableListProps, SortableListItemProps } from \"./types\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport { SortableListProps, SortableListItemProps };\nfunction generateItemsOrder(data) {\n  return _map(data, function (item) {\n    return item.id;\n  });\n}\nfunction generateLockedIds(data) {\n  return _reduce(_filter(data, function (item) {\n    return item.locked;\n  }), function (item, cur) {\n    return _objectSpread(_objectSpread({}, item), {}, _defineProperty({}, cur.id, true));\n  }, {});\n}\nvar SortableList = function SortableList(props) {\n  var themeProps = useThemeProps(props, 'SortableList');\n  var data = themeProps.data,\n    onOrderChange = themeProps.onOrderChange,\n    enableHaptic = themeProps.enableHaptic,\n    scale = themeProps.scale,\n    others = _objectWithoutProperties(themeProps, _excluded);\n  var itemsOrder = useSharedValue(generateItemsOrder(data));\n  var lockedIds = useSharedValue(generateLockedIds(data));\n  var itemHeight = useSharedValue(52);\n  useDidUpdate(function () {\n    itemsOrder.value = generateItemsOrder(data);\n  }, [data]);\n  var onChange = useCallback(function () {\n    var newData = [];\n    var dataByIds = _mapKeys(data, 'id');\n    if (data != null && data.length) {\n      itemsOrder.value.forEach(function (itemId) {\n        newData.push(dataByIds[itemId]);\n      });\n    }\n    onOrderChange == null ? void 0 : onOrderChange(newData);\n  }, [onOrderChange, data]);\n  var onItemLayout = useCallback(function (event) {\n    var newHeight = Math.round(event.nativeEvent.layout.height);\n    itemHeight.value = newHeight;\n  }, []);\n  var context = useMemo(function () {\n    return {\n      data: data,\n      itemsOrder: itemsOrder,\n      lockedIds: lockedIds,\n      onChange: onChange,\n      itemHeight: itemHeight,\n      onItemLayout: onItemLayout,\n      enableHaptic: enableHaptic,\n      scale: scale\n    };\n  }, [data]);\n  return _jsx(GestureHandlerRootView, {\n    children: _jsx(SortableListContext.Provider, {\n      value: context,\n      children: _jsx(FlatList, _objectSpread(_objectSpread({}, others), {}, {\n        data: data,\n        CellRendererComponent: SortableListItem,\n        removeClippedSubviews: false\n      }))\n    })\n  });\n};\nexport default SortableList;","map":{"version":3,"names":["_reduce","_filter","_mapKeys","_map","React","useMemo","useCallback","useSharedValue","GestureHandlerRootView","SortableListContext","SortableListItem","useDidUpdate","useThemeProps","SortableListProps","SortableListItemProps","generateItemsOrder","data","item","id","generateLockedIds","locked","cur","SortableList","props","themeProps","onOrderChange","enableHaptic","scale","others","itemsOrder","lockedIds","itemHeight","value","onChange","newData","dataByIds","length","forEach","itemId","push","onItemLayout","event","newHeight","Math","round","nativeEvent","layout","height","context"],"sources":["C:/Users/Alex/Documents/development/Rabbit/node_modules/react-native-ui-lib/src/components/sortableList/index.js"],"sourcesContent":["import _reduce from \"lodash/reduce\";\nimport _filter from \"lodash/filter\";\nimport _mapKeys from \"lodash/mapKeys\";\nimport _map from \"lodash/map\";\nimport React, { useMemo, useCallback } from 'react';\nimport { FlatList } from 'react-native';\nimport { useSharedValue } from 'react-native-reanimated';\nimport { GestureHandlerRootView } from 'react-native-gesture-handler';\nimport SortableListContext from \"./SortableListContext\";\nimport SortableListItem from \"./SortableListItem\";\nimport { useDidUpdate, useThemeProps } from \"../../hooks\";\nimport { SortableListProps, SortableListItemProps } from \"./types\";\nexport { SortableListProps, SortableListItemProps };\nfunction generateItemsOrder(data) {\n  return _map(data, item => item.id);\n}\nfunction generateLockedIds(data) {\n  return _reduce(_filter(data, item => item.locked), (item, cur) => ({\n    ...item,\n    [cur.id]: true\n  }), {});\n}\nconst SortableList = props => {\n  const themeProps = useThemeProps(props, 'SortableList');\n  const {\n    data,\n    onOrderChange,\n    enableHaptic,\n    scale,\n    ...others\n  } = themeProps;\n  const itemsOrder = useSharedValue(generateItemsOrder(data));\n  const lockedIds = useSharedValue(generateLockedIds(data));\n  const itemHeight = useSharedValue(52);\n  useDidUpdate(() => {\n    itemsOrder.value = generateItemsOrder(data);\n  }, [data]);\n  const onChange = useCallback(() => {\n    const newData = [];\n    const dataByIds = _mapKeys(data, 'id');\n    if (data?.length) {\n      itemsOrder.value.forEach(itemId => {\n        newData.push(dataByIds[itemId]);\n      });\n    }\n    onOrderChange?.(newData);\n  }, [onOrderChange, data]);\n  const onItemLayout = useCallback(event => {\n    // Round height for Android\n    const newHeight = Math.round(event.nativeEvent.layout.height);\n    itemHeight.value = newHeight;\n  }, []);\n  const context = useMemo(() => {\n    return {\n      data,\n      itemsOrder,\n      lockedIds,\n      onChange,\n      itemHeight,\n      onItemLayout,\n      enableHaptic,\n      scale\n    };\n  }, [data]);\n  return <GestureHandlerRootView>\n      <SortableListContext.Provider value={context}>\n        <FlatList {...others} data={data} CellRendererComponent={SortableListItem} removeClippedSubviews={false} // Workaround for crashing on Android (ArrayIndexOutOfBoundsException in ViewGroupDrawingOrderHelper.getChildDrawingOrder)\n      />\n      </SortableListContext.Provider>\n    </GestureHandlerRootView>;\n};\nexport default SortableList;"],"mappings":"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"},"metadata":{},"sourceType":"module"}