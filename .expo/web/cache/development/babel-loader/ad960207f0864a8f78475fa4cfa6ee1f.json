{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nvar _excluded = [\"validate\", \"validationMessage\", \"validateOnBlur\", \"validateOnChange\", \"validateOnStart\", \"onChangeValidity\"];\nimport _isEmpty from \"lodash/isEmpty\";\nimport _isUndefined from \"lodash/isUndefined\";\nimport { useCallback, useState, useEffect, useMemo } from 'react';\nimport * as Presenter from \"./Presenter\";\nimport { useDidUpdate } from \"../../hooks\";\nexport default function useFieldState(_ref) {\n  var validate = _ref.validate,\n    validationMessage = _ref.validationMessage,\n    validateOnBlur = _ref.validateOnBlur,\n    validateOnChange = _ref.validateOnChange,\n    validateOnStart = _ref.validateOnStart,\n    onChangeValidity = _ref.onChangeValidity,\n    props = _objectWithoutProperties(_ref, _excluded);\n  var _useState = useState(props.value),\n    _useState2 = _slicedToArray(_useState, 2),\n    value = _useState2[0],\n    setValue = _useState2[1];\n  var _useState3 = useState(false),\n    _useState4 = _slicedToArray(_useState3, 2),\n    isFocused = _useState4[0],\n    setIsFocused = _useState4[1];\n  var _useState5 = useState(undefined),\n    _useState6 = _slicedToArray(_useState5, 2),\n    isValid = _useState6[0],\n    setIsValid = _useState6[1];\n  var _useState7 = useState(undefined),\n    _useState8 = _slicedToArray(_useState7, 2),\n    failingValidatorIndex = _useState8[0],\n    setFailingValidatorIndex = _useState8[1];\n  useEffect(function () {\n    if (validateOnStart) {\n      validateField();\n    }\n  }, []);\n  useEffect(function () {\n    if (props.value !== value) {\n      setValue(props.value);\n      if (validateOnChange) {\n        validateField(props.value);\n      }\n    }\n  }, [props.value, validateOnChange]);\n  useDidUpdate(function () {\n    if (!_isUndefined(isValid)) {\n      onChangeValidity == null ? void 0 : onChangeValidity(isValid);\n    }\n  }, [isValid]);\n  var checkValidity = useCallback(function () {\n    var valueToValidate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : value;\n    var _Presenter$validate = Presenter.validate(valueToValidate, validate),\n      _Presenter$validate2 = _slicedToArray(_Presenter$validate, 1),\n      _isValid = _Presenter$validate2[0];\n    return _isValid;\n  }, [value, validate]);\n  var validateField = useCallback(function () {\n    var valueToValidate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : value;\n    var _Presenter$validate3 = Presenter.validate(valueToValidate, validate),\n      _Presenter$validate4 = _slicedToArray(_Presenter$validate3, 2),\n      _isValid = _Presenter$validate4[0],\n      _failingValidatorIndex = _Presenter$validate4[1];\n    setIsValid(_isValid);\n    setFailingValidatorIndex(_failingValidatorIndex);\n    return _isValid;\n  }, [value, validate]);\n  var onFocus = useCallback(function () {\n    setIsFocused(true);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    props.onFocus == null ? void 0 : props.onFocus.apply(props, args);\n  }, [props.onFocus]);\n  var onBlur = useCallback(function () {\n    setIsFocused(false);\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n    props.onBlur == null ? void 0 : props.onBlur.apply(props, args);\n    if (validateOnBlur) {\n      validateField();\n    }\n  }, [props.onBlur, validateOnBlur, validateField]);\n  var onChangeText = useCallback(function (text) {\n    setValue(text);\n    props.onChangeText == null ? void 0 : props.onChangeText(text);\n    if (validateOnChange) {\n      validateField(text);\n    }\n  }, [props.onChangeText, validateOnChange, validateField]);\n  var fieldState = useMemo(function () {\n    return {\n      value: value,\n      hasValue: !_isEmpty(value),\n      isValid: validationMessage && !validate ? false : isValid != null ? isValid : true,\n      isFocused: isFocused,\n      failingValidatorIndex: failingValidatorIndex\n    };\n  }, [value, isFocused, isValid, failingValidatorIndex, validationMessage, validate]);\n  return {\n    onFocus: onFocus,\n    onBlur: onBlur,\n    onChangeText: onChangeText,\n    fieldState: fieldState,\n    validateField: validateField,\n    checkValidity: checkValidity\n  };\n}","map":{"version":3,"names":["_isEmpty","_isUndefined","useCallback","useState","useEffect","useMemo","Presenter","useDidUpdate","useFieldState","validate","validationMessage","validateOnBlur","validateOnChange","validateOnStart","onChangeValidity","props","value","setValue","isFocused","setIsFocused","undefined","isValid","setIsValid","failingValidatorIndex","setFailingValidatorIndex","validateField","checkValidity","valueToValidate","_isValid","_failingValidatorIndex","onFocus","args","onBlur","onChangeText","text","fieldState","hasValue"],"sources":["C:/Users/Alex/Documents/development/Rabbit/node_modules/react-native-ui-lib/src/incubator/TextField/useFieldState.js"],"sourcesContent":["import _isEmpty from \"lodash/isEmpty\";\nimport _isUndefined from \"lodash/isUndefined\";\nimport { useCallback, useState, useEffect, useMemo } from 'react';\nimport * as Presenter from \"./Presenter\";\nimport { useDidUpdate } from \"../../hooks\";\nexport default function useFieldState({\n  validate,\n  validationMessage,\n  validateOnBlur,\n  validateOnChange,\n  validateOnStart,\n  onChangeValidity,\n  ...props\n}) {\n  const [value, setValue] = useState(props.value);\n  const [isFocused, setIsFocused] = useState(false);\n  const [isValid, setIsValid] = useState(undefined);\n  const [failingValidatorIndex, setFailingValidatorIndex] = useState(undefined);\n  useEffect(() => {\n    if (validateOnStart) {\n      validateField();\n    }\n  }, []);\n  useEffect(() => {\n    if (props.value !== value) {\n      setValue(props.value);\n      if (validateOnChange) {\n        validateField(props.value);\n      }\n    }\n    /* On purpose listen only to props.value change */\n    /* eslint-disable-next-line react-hooks/exhaustive-deps*/\n  }, [props.value, validateOnChange]);\n  useDidUpdate(() => {\n    if (!_isUndefined(isValid)) {\n      onChangeValidity?.(isValid);\n    }\n  }, [isValid]);\n  const checkValidity = useCallback((valueToValidate = value) => {\n    const [_isValid] = Presenter.validate(valueToValidate, validate);\n    return _isValid;\n  }, [value, validate]);\n  const validateField = useCallback((valueToValidate = value) => {\n    const [_isValid, _failingValidatorIndex] = Presenter.validate(valueToValidate, validate);\n    setIsValid(_isValid);\n    setFailingValidatorIndex(_failingValidatorIndex);\n    return _isValid;\n  }, [value, validate]);\n  const onFocus = useCallback((...args) => {\n    setIsFocused(true);\n    //@ts-expect-error\n    props.onFocus?.(...args);\n  }, [props.onFocus]);\n  const onBlur = useCallback((...args) => {\n    setIsFocused(false);\n    //@ts-expect-error\n    props.onBlur?.(...args);\n    if (validateOnBlur) {\n      validateField();\n    }\n  }, [props.onBlur, validateOnBlur, validateField]);\n  const onChangeText = useCallback(text => {\n    setValue(text);\n    props.onChangeText?.(text);\n    if (validateOnChange) {\n      validateField(text);\n    }\n  }, [props.onChangeText, validateOnChange, validateField]);\n  const fieldState = useMemo(() => {\n    return {\n      value,\n      hasValue: !_isEmpty(value),\n      isValid: validationMessage && !validate ? false : isValid ?? true,\n      isFocused,\n      failingValidatorIndex\n    };\n  }, [value, isFocused, isValid, failingValidatorIndex, validationMessage, validate]);\n  return {\n    onFocus,\n    onBlur,\n    onChangeText,\n    fieldState,\n    validateField,\n    checkValidity\n  };\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}