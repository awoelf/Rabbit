{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _isUndefined from \"lodash/isUndefined\";\nimport _filter from \"lodash/filter\";\nimport _noop from \"lodash/noop\";\nimport React, { useMemo, useEffect, useState, useCallback } from 'react';\nimport { useAnimatedReaction, useSharedValue, withTiming, runOnJS } from 'react-native-reanimated';\nimport { useOrientation, useThemeProps } from \"../../hooks\";\nimport { Constants } from \"../../commons/new\";\nimport { LogService } from \"../../services\";\nimport TabBarContext from \"./TabBarContext\";\nimport TabBar from \"./TabBar\";\nimport TabBarItem, { TabControllerItemProps } from \"./TabBarItem\";\nimport TabPage from \"./TabPage\";\nimport PageCarousel from \"./PageCarousel\";\nimport useImperativeTabControllerHandle, { TabControllerImperativeMethods } from \"./useImperativeTabControllerHandle\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport { TabControllerItemProps, TabControllerImperativeMethods };\nvar getScreenWidth = function getScreenWidth(useSafeArea) {\n  var _Constants$getSafeAre = Constants.getSafeAreaInsets(),\n    left = _Constants$getSafeAre.left,\n    right = _Constants$getSafeAre.right;\n  return Constants.windowWidth - (useSafeArea && Constants.isIphoneX ? left + right : 0);\n};\nvar TabController = React.forwardRef(function (props, ref) {\n  var themeProps = useThemeProps(props, 'TabController');\n  var _themeProps$initialIn = themeProps.initialIndex,\n    initialIndex = _themeProps$initialIn === void 0 ? 0 : _themeProps$initialIn,\n    selectedIndex = themeProps.selectedIndex,\n    _themeProps$asCarouse = themeProps.asCarousel,\n    asCarousel = _themeProps$asCarouse === void 0 ? false : _themeProps$asCarouse,\n    items = themeProps.items,\n    _themeProps$onChangeI = themeProps.onChangeIndex,\n    onChangeIndex = _themeProps$onChangeI === void 0 ? _noop : _themeProps$onChangeI,\n    carouselPageWidth = themeProps.carouselPageWidth,\n    _themeProps$useSafeAr = themeProps.useSafeArea,\n    useSafeArea = _themeProps$useSafeAr === void 0 ? false : _themeProps$useSafeAr,\n    children = themeProps.children;\n  var _useState = useState(getScreenWidth(useSafeArea)),\n    _useState2 = _slicedToArray(_useState, 2),\n    screenWidth = _useState2[0],\n    setScreenWidth = _useState2[1];\n  if ((items == null ? void 0 : items.length) < 2) {\n    console.warn('TabController component expect a minimum of 2 items');\n  }\n  useOrientation({\n    onOrientationChange: function onOrientationChange() {\n      setScreenWidth(getScreenWidth(useSafeArea));\n    }\n  });\n  var pageWidth = useMemo(function () {\n    return carouselPageWidth || screenWidth;\n  }, [carouselPageWidth, screenWidth]);\n  var ignoredItems = useMemo(function () {\n    return _filter(items, function (item) {\n      return item.ignore;\n    });\n  }, [items]);\n  var _initialIndex = selectedIndex || initialIndex;\n  var currentPage = useSharedValue(_initialIndex);\n  var targetPage = useSharedValue(_initialIndex);\n  var setCurrentIndex = useCallback(function () {\n    var _f = function _f(index) {\n      currentPage.value = index;\n    };\n    _f._closure = {\n      currentPage: currentPage\n    };\n    _f.asString = \"function _f(index){const{currentPage}=jsThis._closure;{currentPage.value=index;}}\";\n    _f.__workletHash = 8705844232772;\n    _f.__location = \"C:\\\\Users\\\\Alex\\\\Documents\\\\development\\\\Rabbit\\\\node_modules\\\\react-native-ui-lib\\\\src\\\\components\\\\tabController\\\\index.js (72:38)\";\n    return _f;\n  }(), []);\n  useEffect(function () {\n    if (!_isUndefined(selectedIndex)) {\n      LogService.deprecationWarn({\n        component: 'TabController',\n        oldProp: 'selectedIndex',\n        newProp: 'initialIndex'\n      });\n    }\n  }, [selectedIndex]);\n  useEffect(function () {\n    setCurrentIndex(_initialIndex);\n  }, [_initialIndex]);\n  useAnimatedReaction(function () {\n    var _f = function _f() {\n      return currentPage.value;\n    };\n    _f._closure = {\n      currentPage: currentPage\n    };\n    _f.asString = \"function _f(){const{currentPage}=jsThis._closure;{return currentPage.value;}}\";\n    _f.__workletHash = 16845019634419;\n    _f.__location = \"C:\\\\Users\\\\Alex\\\\Documents\\\\development\\\\Rabbit\\\\node_modules\\\\react-native-ui-lib\\\\src\\\\components\\\\tabController\\\\index.js (89:22)\";\n    return _f;\n  }(), function () {\n    var _f = function _f(value, prevValue) {\n      if (value !== prevValue) {\n        targetPage.value = withTiming(value);\n        prevValue !== null && runOnJS(onChangeIndex)(value, prevValue);\n      }\n    };\n    _f._closure = {\n      targetPage: targetPage,\n      withTiming: withTiming,\n      runOnJS: runOnJS,\n      onChangeIndex: onChangeIndex\n    };\n    _f.asString = \"function _f(value,prevValue){const{targetPage,withTiming,runOnJS,onChangeIndex}=jsThis._closure;{if(value!==prevValue){targetPage.value=withTiming(value);prevValue!==null&&runOnJS(onChangeIndex)(value,prevValue);}}}\";\n    _f.__workletHash = 17508509670657;\n    _f.__location = \"C:\\\\Users\\\\Alex\\\\Documents\\\\development\\\\Rabbit\\\\node_modules\\\\react-native-ui-lib\\\\src\\\\components\\\\tabController\\\\index.js (91:5)\";\n    return _f;\n  }());\n  useImperativeTabControllerHandle(ref, setCurrentIndex);\n  var context = useMemo(function () {\n    return {\n      initialIndex: _initialIndex,\n      asCarousel: asCarousel,\n      pageWidth: pageWidth,\n      items: items,\n      ignoredItems: ignoredItems,\n      itemsCount: items.length - ignoredItems.length,\n      targetPage: targetPage,\n      currentPage: currentPage,\n      containerWidth: screenWidth,\n      onChangeIndex: onChangeIndex,\n      setCurrentIndex: setCurrentIndex\n    };\n  }, [_initialIndex, asCarousel, items, onChangeIndex, screenWidth]);\n  return _jsx(TabBarContext.Provider, {\n    value: context,\n    children: children\n  });\n});\nTabController.TabBar = TabBar;\nTabController.TabBarItem = TabBarItem;\nTabController.TabPage = TabPage;\nTabController.PageCarousel = PageCarousel;\nexport default TabController;","map":{"version":3,"names":["_isUndefined","_filter","_noop","React","useMemo","useEffect","useState","useCallback","useAnimatedReaction","useSharedValue","withTiming","runOnJS","useOrientation","useThemeProps","Constants","LogService","TabBarContext","TabBar","TabBarItem","TabControllerItemProps","TabPage","PageCarousel","useImperativeTabControllerHandle","TabControllerImperativeMethods","getScreenWidth","useSafeArea","getSafeAreaInsets","left","right","windowWidth","isIphoneX","TabController","forwardRef","props","ref","themeProps","initialIndex","selectedIndex","asCarousel","items","onChangeIndex","carouselPageWidth","children","screenWidth","setScreenWidth","length","console","warn","onOrientationChange","pageWidth","ignoredItems","item","ignore","_initialIndex","currentPage","targetPage","setCurrentIndex","index","value","deprecationWarn","component","oldProp","newProp","prevValue","context","itemsCount","containerWidth"],"sources":["C:/Users/Alex/Documents/development/Rabbit/node_modules/react-native-ui-lib/src/components/tabController/index.js"],"sourcesContent":["import _isUndefined from \"lodash/isUndefined\";\nimport _filter from \"lodash/filter\";\nimport _noop from \"lodash/noop\";\n// TODO: support commented props\nimport React, { useMemo, useEffect, useState, useCallback } from 'react';\nimport { useAnimatedReaction, useSharedValue, withTiming, runOnJS } from 'react-native-reanimated';\nimport { useOrientation, useThemeProps } from \"../../hooks\";\nimport { Constants } from \"../../commons/new\";\nimport { LogService } from \"../../services\";\nimport TabBarContext from \"./TabBarContext\";\nimport TabBar from \"./TabBar\";\nimport TabBarItem, { TabControllerItemProps } from \"./TabBarItem\";\nimport TabPage from \"./TabPage\";\nimport PageCarousel from \"./PageCarousel\";\nimport useImperativeTabControllerHandle, { TabControllerImperativeMethods } from \"./useImperativeTabControllerHandle\";\nexport { TabControllerItemProps, TabControllerImperativeMethods };\n\n// TODO: should migrate selectedIndex to initialIndex (and make this prop uncontrolled)\n\nconst getScreenWidth = useSafeArea => {\n  const {\n    left,\n    right\n  } = Constants.getSafeAreaInsets();\n  return Constants.windowWidth - (useSafeArea && Constants.isIphoneX ? left + right : 0);\n};\n\n/**\n * @description: A performant solution for a tab controller with lazy load mechanism\n * @example: https://github.com/wix/react-native-ui-lib/blob/master/demo/src/screens/componentScreens/TabControllerScreen/index.tsx\n * @notes: This component is based on react-native-gesture-handler\n * @important: On Android, if using react-native-navigation, make sure to wrap your screen with gestureHandlerRootHOC\n * @importantLink: https://kmagiera.github.io/react-native-gesture-handler/docs/getting-started.html#with-wix-react-native-navigation-https-githubcom-wix-react-native-navigation\n */\nconst TabController = React.forwardRef((props, ref) => {\n  const themeProps = useThemeProps(props, 'TabController');\n  const {\n    initialIndex = 0,\n    selectedIndex,\n    asCarousel = false,\n    items,\n    onChangeIndex = _noop,\n    carouselPageWidth,\n    useSafeArea = false,\n    children\n  } = themeProps;\n  const [screenWidth, setScreenWidth] = useState(getScreenWidth(useSafeArea));\n  if (items?.length < 2) {\n    console.warn('TabController component expect a minimum of 2 items');\n  }\n  useOrientation({\n    onOrientationChange: () => {\n      setScreenWidth(getScreenWidth(useSafeArea));\n    }\n  });\n  const pageWidth = useMemo(() => {\n    return carouselPageWidth || screenWidth;\n  }, [carouselPageWidth, screenWidth]);\n  const ignoredItems = useMemo(() => {\n    return _filter(items, item => item.ignore);\n  }, [items]);\n\n  /* backwards compatibility for `selectedIndex` prop. this line eventually should be removed */\n  const _initialIndex = selectedIndex || initialIndex;\n\n  /* currentPage - static page index */\n  const currentPage = useSharedValue(_initialIndex);\n  /* targetPage - transitioned page index (can be a fraction when transitioning between pages) */\n  const targetPage = useSharedValue(_initialIndex);\n  // const carouselOffset = useSharedValue(initialIndex * Math.round(pageWidth));\n\n  const setCurrentIndex = useCallback(index => {\n    'worklet';\n\n    currentPage.value = index;\n  }, []);\n  useEffect(() => {\n    if (!_isUndefined(selectedIndex)) {\n      LogService.deprecationWarn({\n        component: 'TabController',\n        oldProp: 'selectedIndex',\n        newProp: 'initialIndex'\n      });\n    }\n  }, [selectedIndex]);\n  useEffect(() => {\n    setCurrentIndex(_initialIndex);\n  }, [_initialIndex]);\n  useAnimatedReaction(() => {\n    return currentPage.value;\n  }, (value, prevValue) => {\n    if (value !== prevValue) {\n      targetPage.value = withTiming(value);\n      prevValue !== null && runOnJS(onChangeIndex)(value, prevValue);\n    }\n  });\n  useImperativeTabControllerHandle(ref, setCurrentIndex);\n  const context = useMemo(() => {\n    return {\n      /* Pass Props */\n      initialIndex: _initialIndex,\n      asCarousel,\n      pageWidth,\n      /* Items */\n      items,\n      ignoredItems,\n      itemsCount: items.length - ignoredItems.length,\n      /* Animated Values */\n      targetPage,\n      currentPage,\n      // carouselOffset,\n      containerWidth: screenWidth,\n      /* Callbacks */\n      onChangeIndex,\n      setCurrentIndex\n    };\n  }, [_initialIndex, asCarousel, items, onChangeIndex, screenWidth]);\n  return <TabBarContext.Provider value={context}>{children}</TabBarContext.Provider>;\n});\n\n// @ts-expect-error\nTabController.TabBar = TabBar;\n// @ts-expect-error\nTabController.TabBarItem = TabBarItem;\n// @ts-expect-error\nTabController.TabPage = TabPage;\n// @ts-expect-error\nTabController.PageCarousel = PageCarousel;\nexport default TabController;"],"mappings":";AAAA,OAAOA,YAAY,MAAM,oBAAoB;AAC7C,OAAOC,OAAO,MAAM,eAAe;AACnC,OAAOC,KAAK,MAAM,aAAa;AAE/B,OAAOC,KAAK,IAAIC,OAAO,EAAEC,SAAS,EAAEC,QAAQ,EAAEC,WAAW,QAAQ,OAAO;AACxE,SAASC,mBAAmB,EAAEC,cAAc,EAAEC,UAAU,EAAEC,OAAO,QAAQ,yBAAyB;AAClG,SAASC,cAAc,EAAEC,aAAa;AACtC,SAASC,SAAS;AAClB,SAASC,UAAU;AACnB,OAAOC,aAAa;AACpB,OAAOC,MAAM;AACb,OAAOC,UAAU,IAAIC,sBAAsB;AAC3C,OAAOC,OAAO;AACd,OAAOC,YAAY;AACnB,OAAOC,gCAAgC,IAAIC,8BAA8B;AAA6C;AACtH,SAASJ,sBAAsB,EAAEI,8BAA8B;AAI/D,IAAMC,cAAc,GAAG,SAAjBA,cAAc,CAAGC,WAAW,EAAI;EACpC,4BAGIX,SAAS,CAACY,iBAAiB,EAAE;IAF/BC,IAAI,yBAAJA,IAAI;IACJC,KAAK,yBAALA,KAAK;EAEP,OAAOd,SAAS,CAACe,WAAW,IAAIJ,WAAW,IAAIX,SAAS,CAACgB,SAAS,GAAGH,IAAI,GAAGC,KAAK,GAAG,CAAC,CAAC;AACxF,CAAC;AASD,IAAMG,aAAa,GAAG5B,KAAK,CAAC6B,UAAU,CAAC,UAACC,KAAK,EAAEC,GAAG,EAAK;EACrD,IAAMC,UAAU,GAAGtB,aAAa,CAACoB,KAAK,EAAE,eAAe,CAAC;EACxD,4BASIE,UAAU,CARZC,YAAY;IAAZA,YAAY,sCAAG,CAAC;IAChBC,aAAa,GAOXF,UAAU,CAPZE,aAAa;IAAA,wBAOXF,UAAU,CANZG,UAAU;IAAVA,UAAU,sCAAG,KAAK;IAClBC,KAAK,GAKHJ,UAAU,CALZI,KAAK;IAAA,wBAKHJ,UAAU,CAJZK,aAAa;IAAbA,aAAa,sCAAGtC,KAAK;IACrBuC,iBAAiB,GAGfN,UAAU,CAHZM,iBAAiB;IAAA,wBAGfN,UAAU,CAFZV,WAAW;IAAXA,WAAW,sCAAG,KAAK;IACnBiB,QAAQ,GACNP,UAAU,CADZO,QAAQ;EAEV,gBAAsCpC,QAAQ,CAACkB,cAAc,CAACC,WAAW,CAAC,CAAC;IAAA;IAApEkB,WAAW;IAAEC,cAAc;EAClC,IAAI,CAAAL,KAAK,oBAALA,KAAK,CAAEM,MAAM,IAAG,CAAC,EAAE;IACrBC,OAAO,CAACC,IAAI,CAAC,qDAAqD,CAAC;EACrE;EACAnC,cAAc,CAAC;IACboC,mBAAmB,EAAE,+BAAM;MACzBJ,cAAc,CAACpB,cAAc,CAACC,WAAW,CAAC,CAAC;IAC7C;EACF,CAAC,CAAC;EACF,IAAMwB,SAAS,GAAG7C,OAAO,CAAC,YAAM;IAC9B,OAAOqC,iBAAiB,IAAIE,WAAW;EACzC,CAAC,EAAE,CAACF,iBAAiB,EAAEE,WAAW,CAAC,CAAC;EACpC,IAAMO,YAAY,GAAG9C,OAAO,CAAC,YAAM;IACjC,OAAOH,OAAO,CAACsC,KAAK,EAAE,UAAAY,IAAI;MAAA,OAAIA,IAAI,CAACC,MAAM;IAAA,EAAC;EAC5C,CAAC,EAAE,CAACb,KAAK,CAAC,CAAC;EAGX,IAAMc,aAAa,GAAGhB,aAAa,IAAID,YAAY;EAGnD,IAAMkB,WAAW,GAAG7C,cAAc,CAAC4C,aAAa,CAAC;EAEjD,IAAME,UAAU,GAAG9C,cAAc,CAAC4C,aAAa,CAAC;EAGhD,IAAMG,eAAe,GAAGjD,WAAW;IAAA,qBAACkD,KAAK,EAAI;MAG3CH,WAAW,CAACI,KAAK,GAAGD,KAAK;IAC3B,CAAC;IAAA;MAAA,aAzEDH;IAAW;IAAA;IAAA;IAAA;IAAA;EAAA,KAyER,EAAE,CAAC;EACNjD,SAAS,CAAC,YAAM;IACd,IAAI,CAACL,YAAY,CAACqC,aAAa,CAAC,EAAE;MAChCtB,UAAU,CAAC4C,eAAe,CAAC;QACzBC,SAAS,EAAE,eAAe;QAC1BC,OAAO,EAAE,eAAe;QACxBC,OAAO,EAAE;MACX,CAAC,CAAC;IACJ;EACF,CAAC,EAAE,CAACzB,aAAa,CAAC,CAAC;EACnBhC,SAAS,CAAC,YAAM;IACdmD,eAAe,CAACH,aAAa,CAAC;EAChC,CAAC,EAAE,CAACA,aAAa,CAAC,CAAC;EACnB7C,mBAAmB;IAAA,uBAAO;MACxB,OAAO8C,WAAW,CAACI,KAAK;IAC1B,CAAC;IAAA;MAAA,aAxFMJ;IAAW;IAAA;IAAA;IAAA;IAAA;EAAA;IAAA,qBAwFdI,KAAK,EAAEK,SAAS,EAAK;MACvB,IAAIL,KAAK,KAAKK,SAAS,EAAE;QACvBR,UAAU,CAACG,KAAK,GAAGhD,UAAU,CAACgD,KAAK,CAAC;QACpCK,SAAS,KAAK,IAAI,IAAIpD,OAAO,CAAC6B,aAAa,CAAC,CAACkB,KAAK,EAAEK,SAAS,CAAC;MAChE;IACF,CAAC;IAAA;MAAA,YA5FCR,UAAU;MAAA,YAAS7C,UAAU;MAAA,SACPC,OAAO;MAAA,eAAC6B;IAAa;IAAA;IAAA;IAAA;IAAA;EAAA,IA2F3C;EACFlB,gCAAgC,CAACY,GAAG,EAAEsB,eAAe,CAAC;EACtD,IAAMQ,OAAO,GAAG5D,OAAO,CAAC,YAAM;IAC5B,OAAO;MAELgC,YAAY,EAAEiB,aAAa;MAC3Bf,UAAU,EAAVA,UAAU;MACVW,SAAS,EAATA,SAAS;MAETV,KAAK,EAALA,KAAK;MACLW,YAAY,EAAZA,YAAY;MACZe,UAAU,EAAE1B,KAAK,CAACM,MAAM,GAAGK,YAAY,CAACL,MAAM;MAE9CU,UAAU,EAAVA,UAAU;MACVD,WAAW,EAAXA,WAAW;MAEXY,cAAc,EAAEvB,WAAW;MAE3BH,aAAa,EAAbA,aAAa;MACbgB,eAAe,EAAfA;IACF,CAAC;EACH,CAAC,EAAE,CAACH,aAAa,EAAEf,UAAU,EAAEC,KAAK,EAAEC,aAAa,EAAEG,WAAW,CAAC,CAAC;EAClE,OAAO,KAAC,aAAa,CAAC,QAAQ;IAAC,KAAK,EAAEqB,OAAQ;IAAA,UAAEtB;EAAQ,EAA0B;AACpF,CAAC,CAAC;AAGFX,aAAa,CAACd,MAAM,GAAGA,MAAM;AAE7Bc,aAAa,CAACb,UAAU,GAAGA,UAAU;AAErCa,aAAa,CAACX,OAAO,GAAGA,OAAO;AAE/BW,aAAa,CAACV,YAAY,GAAGA,YAAY;AACzC,eAAeU,aAAa"},"metadata":{},"sourceType":"module"}